import speech_recognition as sr
import tkinter as tk
from tkinter import messagebox
from googletrans import Translator

# Language dictionary
language_codes = {
    "English (India)": "en-IN",
    "Hindi": "hi-IN",
    "Tamil": "ta-IN",
    "Telugu": "te-IN",
    "French": "fr-FR",
    "German": "de-DE"
}

translate_codes = {
    "English": "en",
    "Hindi": "hi",
    "Tamil": "ta",
    "Telugu": "te",
    "French": "fr",
    "German": "de"
}

def recognize_and_translate():
    recognizer = sr.Recognizer()
    source_lang = language_codes[source_lang_var.get()]
    target_lang = translate_codes[target_lang_var.get()]

    with sr.Microphone() as source:
        print("Listening...")
        audio = recognizer.listen(source)
    try:
        # Speech to Text
        text = recognizer.recognize_google(audio, language=source_lang)
        print(f"Recognized Text: {text}")
        # Translate Text
        translator = Translator()
        translated = translator.translate(text, dest=target_lang)
        print(f"Translated Text: {translated.text}")
        text_box.delete("1.0", tk.END)
        text_box.insert(tk.END, translated.text)
    except sr.UnknownValueError:
        messagebox.showerror("Error", "Could not understand the audio.")
    except sr.RequestError:
        messagebox.showerror("Error", "Request failed. Check internet connection.")

# GUI
app = tk.Tk()
app.title("Voice Translator")
app.geometry("500x400")

tk.Label(app, text="Select Input Voice Language", font=("Arial", 12)).pack(pady=5)
source_lang_var = tk.StringVar(app)
source_lang_var.set("English (India)")
tk.OptionMenu(app, source_lang_var, *language_codes.keys()).pack(pady=5)

tk.Label(app, text="Translate To", font=("Arial", 12)).pack(pady=5)
target_lang_var = tk.StringVar(app)
target_lang_var.set("Hindi")
tk.OptionMenu(app, target_lang_var, *translate_codes.keys()).pack(pady=5)

tk.Button(app, text="Start Recording & Translate", command=recognize_and_translate, font=("Arial", 12)).pack(pady=10)

text_box = tk.Text(app, height=10, width=50)
text_box.pack(pady=10)

app.mainloop()
